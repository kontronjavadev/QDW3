<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="jakarta.faces.facelets"
	xmlns:h="jakarta.faces.html"
	xmlns:f="jakarta.faces.core"
	xmlns:p="http://primefaces.org/ui"
	template="/templates/ui.xhtml">

<f:metadata>
	<f:viewAction action="#{businessUnitView.fetchBusinessUnits()}"/>
</f:metadata>

<ui:define name="title">#{businessUnitView.formTitle}</ui:define>

<ui:define name="content">
	<h:panelGrid columns="3">
		<div class="pi pi-list" style="font-size: 2em"/>
		<h:outputText id="lblFormTitle" value="&#160;#{businessUnitView.formTitle}" styleClass="label-form-title"/>
		<p:ajaxStatus style="width:16px;height:16px;">
			<f:facet name="start">
				<h:graphicImage value="/images/ajaxloading.gif"/>
			</f:facet>

			<f:facet name="complete">
				<h:outputText value=""/>
			</f:facet>
		</p:ajaxStatus>
	</h:panelGrid>

	<p:growl id="growl" showDetail="true"/>

	<p:menubar>
		<p:submenu icon="pi pi-file" label="#{i18n.mnu_file}" id="panData_mniFile">
			<p:menuitem value="#{i18n.action_create}" ajax="true" id="panData_mniCreate" icon="pi pi-plus" rendered="#{userSession.checkAuthorizationString('ADMINISTRATOR')}" action="#{businessUnitView.openCreateNewBusinessUnitDialog}">
				<f:setPropertyActionListener target="#{userSession.lastPage}" value="#{businessUnitView.currentPageURL}"/>
			</p:menuitem>
		</p:submenu>
		<p:submenu icon="pi pi-refresh" label="#{i18n.mnu_view}">
			<p:menuitem value="#{i18n.action_refresh}" ajax="false" icon="pi pi-refresh" actionListener="#{businessUnitView.fetchBusinessUnits}"/>
		</p:submenu>
		<p:submenu icon="pi pi-print" label="#{i18n.mnu_export}">
			<p:menuitem value="#{i18n.action_export_xls}" ajax="false" icon="pi pi-file-excel">
				<p:dataExporter type="xls" target="panData" fileName="BusinessUnitList"/>
			</p:menuitem>
			<p:menuitem value="#{i18n.action_export_pdf}" ajax="false" icon="pi pi-file-pdf">
				<p:dataExporter type="pdf" target="panData" fileName="BusinessUnitList"/>
			</p:menuitem>
		</p:submenu>
	</p:menubar>


	<p:dataTable id="panData" var="businessUnitViewItem" rows="50"
		selectionMode="single"
		selection="#{businessUnitView.selectedObject}"
		loadingMessage="#{i18n.action_fetch_data}"
		value="#{businessUnitView.businessUnitsList}" scrollable="false"
		paginatorPosition="top" paginatorAlwaysVisible="false" paginator="true" resizableColumns="true"
		rowKey="#{businessUnitViewItem.code}"
		paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
		rowsPerPageTemplate="10,50,100,500,1000">
		<p:ajax event="rowDblselect" listener="#{businessUnitView.onDoubleClick}"/>

		<p:column sortBy="#{businessUnitViewItem.code}" width="100" >
			<f:facet name="header">
				<h:outputText value="#{i18n.lbl_attr_abstractfunctionalactiveentity_code}"/>
			</f:facet>
			<h:outputText value="#{businessUnitViewItem.code}">
			</h:outputText>
		</p:column>

		<p:column sortBy="#{businessUnitViewItem.shortText}" width="150" 
			exportValue="#{businessUnitViewItem.shortText}" class="tdnowrap" >
			<f:facet name="header">
				<h:outputText value="#{i18n.lbl_attr_abstractfunctionalactiveentity_shorttext}"/>
			</f:facet>
			<h:outputText value="#{businessUnitViewItem.shortText}" id="shortText"/>
			<p:tooltip for="shortText" value="#{businessUnitViewItem.shortText}" position="top" showDelay="50"/>
		</p:column>

		<p:column sortBy="#{businessUnitViewItem.comment}" width="250" 
			exportValue="#{businessUnitViewItem.comment}" class="tdnowrap" >
			<f:facet name="header">
				<h:outputText value="#{i18n.lbl_attr_abstractfunctionalactiveentity_comment}"/>
			</f:facet>
			<h:outputText value="#{businessUnitViewItem.comment}" id="comment"/>
			<p:tooltip for="comment" value="#{businessUnitViewItem.comment}" position="top" showDelay="50"/>
		</p:column>

		<p:column sortBy="#{businessUnitViewItem.active}" width="70" >
			<f:facet name="header">
				<h:outputText value="#{i18n.lbl_attr_abstractfunctionalactiveentity_active}"/>
			</f:facet>
			<p:selectBooleanCheckbox value="#{businessUnitViewItem.active}" disabled="true"/>
		</p:column>

		<p:column sortBy="#{businessUnitViewItem.creationDate}" width="120" >
			<f:facet name="header">
				<h:outputText value="#{i18n.lbl_attr_abstractfunctionalactiveentity_creationdate}"/>
			</f:facet>
			<h:outputText value="#{businessUnitViewItem.creationDate}">
				<f:converter converterId="net.sourceforge.jbizmo.commons.webclient.primefaces.converter.LocalDateTimeConverter"/>
				<f:attribute name="pattern" value="#{userSession.dateTimeFormat}"/>
				<f:attribute name="timeZone" value="#{userSession.timeZone}"/>
			</h:outputText>
		</p:column>

		<p:column sortBy="#{businessUnitViewItem.lastUpdate}" width="120" >
			<f:facet name="header">
				<h:outputText value="#{i18n.lbl_attr_abstractfunctionalactiveentity_lastupdate}"/>
			</f:facet>
			<h:outputText value="#{businessUnitViewItem.lastUpdate}">
				<f:converter converterId="net.sourceforge.jbizmo.commons.webclient.primefaces.converter.LocalDateTimeConverter"/>
				<f:attribute name="pattern" value="#{userSession.dateTimeFormat}"/>
				<f:attribute name="timeZone" value="#{userSession.timeZone}"/>
			</h:outputText>
		</p:column>
	</p:dataTable>
	<p/>

	<h:outputText styleClass="label-field-mandatory" value="#{i18n.result_total_number_records} #{businessUnitView.businessUnitsList.size()}"/>
	<p/>

	<p:contextMenu for="panData">
		<p:menuitem value="#{i18n.action_delete}" ajax="true" icon="pi pi-trash" id="panData_mniDelete" rendered="#{userSession.checkAuthorizationString('ADMINISTRATOR')}" onclick="PF('deleteConfirm').show()"/>
		<p:menuitem value="#{i18n.action_edit}" ajax="true" icon="pi pi-pencil" id="panData_mniUpdate" rendered="#{userSession.checkAuthorizationString('ADMINISTRATOR')}" action="#{businessUnitView.openEditBusinessUnitDialog}">
			<f:setPropertyActionListener target="#{userSession.lastPage}" value="#{businessUnitView.currentPageURL}"/>
		</p:menuitem>
		<p:menuitem value="#{i18n.action_copy}" ajax="true" icon="pi pi-copy" id="panData_mniCopy" rendered="#{userSession.checkAuthorizationString('ADMINISTRATOR')}" onclick="PF('copyConfirm').show()"/>
		<p:menuitem value="#{i18n.action_create}" ajax="true" icon="pi pi-plus" rendered="#{userSession.checkAuthorizationString('ADMINISTRATOR')}" action="#{businessUnitView.openCreateNewBusinessUnitDialog}">
			<f:setPropertyActionListener target="#{userSession.lastPage}" value="#{businessUnitView.currentPageURL}"/>
		</p:menuitem>
		<p:menuitem value="#{i18n.action_refresh}" ajax="false" type="push" icon="pi pi-refresh" id="panData_mniRefresh" actionListener="#{businessUnitView.fetchBusinessUnits}"/>
	</p:contextMenu>

	<p:confirmDialog modal="true" closeOnEscape="true" message="#{i18n.dialog_delete_question}" header="#{i18n.dialog_delete_title}" severity="warn" widgetVar="deleteConfirm">
		<p:commandButton value="#{i18n.command_yes}" oncomplete="PF('deleteConfirm').hide()" actionListener="#{businessUnitView.deleteBusinessUnit}" id="panData_cmdYesDelete" ajax="false"/>
		<p:commandButton value="#{i18n.command_no}" onclick="PF('deleteConfirm').hide()" type="button"/>
	</p:confirmDialog>

	<p:confirmDialog modal="true" closeOnEscape="true" message="#{i18n.dialog_copy_question}" header="#{i18n.dialog_copy_title}" severity="info" widgetVar="copyConfirm">
		<p:commandButton value="#{i18n.command_yes}" oncomplete="PF('copyConfirm').hide()" action="#{businessUnitView.copy}" id="panData_cmdYesCopy" ajax="false"/>
		<p:commandButton value="#{i18n.command_no}" onclick="PF('copyConfirm').hide()" type="button"/>
	</p:confirmDialog>

</ui:define>
</ui:composition>
